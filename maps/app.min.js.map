{"version":3,"sources":["app.min.js"],"names":["Blockly","Blocks","init","this","appendValueInput","setCheck","appendField","setInputsInline","setPreviousStatement","setNextStatement","setColour","setTooltip","setHelpUrl","JavaScript","block","valueToCode","ORDER_ATOMIC","Arduino","setOutput","Types","NUMBER","output","appendDummyInput","FieldDropdown","getBlockType","getFieldValue","FieldColour","String","prototype","format","str","toString","arguments","length","key","t","args","Array","slice","call","replace","RegExp","app","models","Backbone","Model","extend","defaults","initialize","exportWorkspaceXml","xmlDom","Xml","workspaceToDom","get","domToPrettyText","addWorkspaceOnChangeListener","onChange","addChangeListener","removeWorkspaceOnChangeListener","removeChangeListener","exportWorkspaceArduino","code","workspaceToCode","setupRE","loopRE","allDefsRE","allDefs","match","setup","loop","arduinoCode","exportWorkspaceJavascript","importWorkspaceXml","xmlText","clear","textToDom","domToWorkspace","codeIsEmpty","trim","clearWorkspace","FileSave","fileExtension","defaultFileName","extractCode","downloadWithFileName","fileName","text","saveTextAsFile","formatFileName","filename","ie","navigator","userAgent","ie11","ieEDGE","ieVer","console","log","textFileAsBlob","Blob","type","window","msSaveBlob","downloadLink","document","createElement","download","href","URL","createObjectURL","onclick","e","body","removeChild","target","style","display","appendChild","click","extension","substr","Simulator","onWorkspaceChangeCallback","$","proxy","onWorkspaceChange","enableSensorsHUD","me","game","HUD","enableHUD","disableSensorsHUD","disableHUD","event","Events","CHANGE","CREATE","DELETE","execution","finish","blocklyModel","pause","onPause","isRunning","stop","onStop","hasFinished","state","change","PLAY","run","onRun","onCompleted","module","notifyEmptyProgram","interpreter","createInterpreter","resume","isPaused","changeMap","mapName","_","throttle","toastr","info","timeOut","trailing","notifySaturationLeftWheel","notifySaturation","notifySaturationRightWheel","mensaje","warning","SimulatorInterpreter","Interpreter","initApi","scope","robotInstructions","setProperty","createAsyncFunction","sensorName","callback","push","action","sensorResultCallback","createNativeFunction","leftWheelValue","rightWheelValue","durationValue","data","Math","max","min","simulatorModel","createPrimitive","leftWheel","rightWheel","duration","colour","enabled","views","AppView","View","material","$homeNavbarCollapseElement","$el","find","$homeContentElement","$homeBlocklyWrapperElement","$homeSimulatorWrapperElement","$mapsModalElement","$stateIndicatorElement","setInitialLayoutMode","on","blocklyView","forceBlocklySvgResize","toggleLayoutMode","contains","getState","setLayoutModeCollapsed","setLayoutModeExpanded","removeClass","addClass","simulatorView","enableSimulatorDragging","onContainerResize","disableSimulatorDragging","hasClass","getComputedStyle","getPropertyValue","events","change #hidden-file-input","render","blocklyOptions","media","sounds","toolbox","getElementById","rtl","collapse","comments","css","disable","grid","maxBlocks","Infinity","zoom","controls","wheel","startScale","maxScale","minScale","scaleSpeed","workspace","inject","model","set","INFINITE_LOOP_TRAP","math","HUE","$hiddenFileInputElement","$blocklyDivElement","$blocklyDivWrapperElement","parent","bind","wrapperWidth","width","wrapperHeight","height","svgResize","loadProgram","onTextLoad","result","onHiddenFileInputChange","files","fileToLoad","reader","FileReader","onload","readAsText","ConfigView","changeHUDCheckbox","$modal","show","modal","hide","configView","navBarView","toggleNavbar","is","click .file-download-button","click .file-cancel-button","keypress .file-download-name-input","$fileNameInput","focus","onSaveButtonClick","val","onInputKeyPress","which","preventDefault","onCancelButtonClick","MapsSelectorView","onMapSelectionClick","selectedMap","attr","mapsSelectorView","bootbox","dialog","message","title","buttons","default","label","className","success","NavBar","click .btn_run","click .btn_pause","click .btn_stop","click .btn_save","click .btn_export","click .btn_load","click .btn_maps","click .btn_config","keyHandler","handler","stopPropagation","$btn_run","$btn_pause","$btn_stop","$btn_save","$btn_export","$btn_load","$btn_maps","$home_navbar_collapse","$home_navbar_collapse_button","onClickSave","onClickLoad","onClickRun","onClickPause","onClickStop","onClickMaps","onClickConfig","downloadCodeView","onClickExport","exportCodeView","device","isMobile","isCocoonJS","addEventListener","scroll","scrollTo","video","onresize","defer","subscribe","WINDOW_ONRESIZE","$screenElement","$canvasElement","screenWrapperElement","screenWrapperWidth","screenWrapperHeight","screenWidth","screenHeight","draggable","containment","resetDraggablePosition","ready","el","downloadCodeModel","exportCodeModel","simulatorInterpreterModel","appView"],"mappings":"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","file":"../others/app.min.js","sourcesContent":["\"use strict\";\n\n(function() {\n\n  Blockly.Blocks['robotica_motor'] = {\n    init: function() {\n      this.appendValueInput(\"leftWheel\")\n          .setCheck(\"Number\")\n          .appendField(\"Rueda izquierda\");\n      this.appendValueInput(\"rightWheel\")\n          .setCheck(\"Number\")\n          .appendField(\"Rueda derecha\");\n      this.appendValueInput(\"duration\")\n          .setCheck(\"Number\")\n          .appendField(\"Duración\");\n      this.setInputsInline(true);\n      this.setPreviousStatement(true, null);\n      this.setNextStatement(true, null);\n      this.setColour(65);\n      this.setTooltip('Hacer que el robot se mueva con determinada potencia en cada rueda durante el tiempo definido.');\n      this.setHelpUrl('http://www.example.com/');\n    }\n  };\n\n  /* TODO repeated code */\n  Blockly.JavaScript['robotica_motor'] = function(block) {\n    var value_leftwheel = Blockly.JavaScript.valueToCode(block, 'leftWheel', Blockly.JavaScript.ORDER_ATOMIC);\n    var value_rightwheel = Blockly.JavaScript.valueToCode(block, 'rightWheel', Blockly.JavaScript.ORDER_ATOMIC);\n    var value_duration = Blockly.JavaScript.valueToCode(block, 'duration', Blockly.JavaScript.ORDER_ATOMIC);\n    var code = \"motor(\" + value_leftwheel + ', ' + value_rightwheel + ', ' + value_duration + ');\\n';\n    return code;\n  };\n\n  Blockly.Arduino['robotica_motor'] = function(block) {\n    var value_leftwheel = Blockly.JavaScript.valueToCode(block, 'leftWheel', Blockly.JavaScript.ORDER_ATOMIC);\n    var value_rightwheel = Blockly.JavaScript.valueToCode(block, 'rightWheel', Blockly.JavaScript.ORDER_ATOMIC);\n    var value_duration = Blockly.JavaScript.valueToCode(block, 'duration', Blockly.JavaScript.ORDER_ATOMIC);\n    var code = \"motor(\" + value_leftwheel + ', ' + value_rightwheel + ', ' + value_duration + ');\\n';\n    return code;\n  }\n\n  Blockly.Blocks['robotica_sensor'] = {\n    init: function() {\n      this.setOutput(true, Blockly.Types.NUMBER.output);\n      this.appendDummyInput()\n          .appendField(\"Sensor\")\n          .appendField(new Blockly.FieldDropdown([[\"Izquierda\", \"left\"], [\"Derecha\", \"right\"], [\"Adelante\", \"front\"]]), \"Sensor\");\n      this.setColour(65);\n      this.setTooltip('Activa el sensor de proximidad en la dirección determinada.');\n      this.setHelpUrl('http://www.example.com/');\n    },\n    getBlockType: function() {\n      return Blockly.Types.NUMBER;\n    }\n  };\n\n  /* TODO repeated code */\n  Blockly.JavaScript['robotica_sensor'] = function(block) {\n    var dropdown_sensor = block.getFieldValue('Sensor');\n    var code = 'sensor(\\'' + dropdown_sensor + '\\')';\n    return [code, Blockly.JavaScript.ORDER_ATOMIC];\n  };\n\n  Blockly.Arduino['robotica_sensor'] = function(block) {\n    var dropdown_sensor = block.getFieldValue('Sensor');\n    var code = 'sense('+ dropdown_sensor + ')';\n    return [code, Blockly.JavaScript.ORDER_ATOMIC];\n  };\n\n  /* Enables or disables tracing support */\n  Blockly.Blocks['robotica_tracer_status'] = {\n    init: function() {\n      this.appendValueInput(\"enable\")\n          .setCheck(\"Boolean\")\n          .appendField(\"Traza habilitada\");\n      this.setPreviousStatement(true, null);\n      this.setNextStatement(true, null);\n      this.setColour(65);\n      this.setTooltip('Si es verdadero, entonces habilita la traza.');\n      this.setHelpUrl('http://www.example.com/');\n    }\n  };\n\n  Blockly.JavaScript['robotica_tracer_status'] = function(block) {\n    var value_enable = Blockly.JavaScript.valueToCode(block, 'enable', Blockly.JavaScript.ORDER_ATOMIC);\n    var code = 'tracer(' + value_enable + ');\\n';\n    return code;\n  };\n\n  Blockly.Arduino['robotica_tracer_status'] = function(block) {\n    return \"\";\n  };\n\n  /* Sets tracer's colour */\n  Blockly.Blocks['robotica_tracer_colour'] = {\n    init: function() {\n      this.appendDummyInput()\n          .appendField(\"Color de traza\")\n          .appendField(new Blockly.FieldColour(\"#ff0000\"), \"trace_colour\");\n      this.setPreviousStatement(true, null);\n      this.setNextStatement(true, null);\n      this.setColour(65);\n      this.setTooltip('Define el color de la traza.');\n      this.setHelpUrl('http://www.example.com/');\n    }\n  };\n\n  Blockly.JavaScript['robotica_tracer_colour'] = function(block) {\n    var trace_colour = block.getFieldValue('trace_colour');\n    var code = 'tracer_colour(\\''+ trace_colour +'\\');\\n';\n    return code;\n  };\n\n  Blockly.Arduino['robotica_tracer_colour'] = function(block) {\n    return \"\";\n  };\n\n  /* Just for debugging */\n  Blockly.Blocks['console_log'] = {\n    init: function() {\n      this.appendValueInput(\"text\")\n          .setCheck(null)\n          .appendField(\"Texto\");\n      this.setPreviousStatement(true, null);\n      this.setNextStatement(true, null);\n      this.setColour(20);\n      this.setTooltip('');\n      this.setHelpUrl('http://www.example.com/');\n    }\n  };\n\n  Blockly.JavaScript['console_log'] = function(block) {\n    var value_text = Blockly.JavaScript.valueToCode(block, 'text', Blockly.JavaScript.ORDER_ATOMIC);\n    // TODO: Assemble JavaScript into code variable.\n    var code = 'console_log(' + value_text + ');\\n';\n    return [code, Blockly.JavaScript.ORDER_ATOMIC];\n  };\n\n})();\n\n\n\n\"use strict\";\n\nString.prototype.format = String.prototype.format ||\nfunction () {\n    var str = this.toString();\n    if (arguments.length) {\n        var t = typeof arguments[0];\n        var key;\n        var args = (\"string\" === t || \"number\" === t) ?\n            Array.prototype.slice.call(arguments)\n            : arguments[0];\n\n        for (key in args) {\n            str = str.replace(new RegExp(\"\\\\{\" + key + \"\\\\}\", \"gi\"), args[key]);\n        }\n    }\n\n    return str;\n};\n\"use strict\";\n\nthis.app = app || {};\n\nthis.app.models = app.models || {};\n\nthis.app.models.Blockly = Backbone.Model.extend({\n  defaults: {},\n\n  initialize: function() {\n\n  },\n\n  exportWorkspaceXml : function() {\n    var xmlDom = Blockly.Xml.workspaceToDom(this.get('workspace'));\n    var xmlText = Blockly.Xml.domToPrettyText(xmlDom);\n    return xmlText;\n  },\n\n  addWorkspaceOnChangeListener : function(onChange) {\n    this.get('workspace').addChangeListener(onChange);\n  },\n\n  removeWorkspaceOnChangeListener : function(onChange) {\n    this.get('workspace').removeChangeListener(onChange);\n  },\n\n  exportWorkspaceArduino : function() {\n    var code = Blockly.Arduino.workspaceToCode(this.get('workspace'));\n    var setupRE = /void setup\\(.*\\) \\{([\\s\\S]*?)\\}[\\s\\S]*void loop/;\n    var loopRE = /void loop\\(.*\\) \\{([\\s\\S]*?)\\s\\}$/;\n    var allDefsRE = /([\\s\\S]*?)void setup()/;\n    var allDefs = code.match(allDefsRE)[1];\n    var setup = code.match(setupRE)[1];\n    var loop = code.match(loopRE)[1];\n    return arduinoCode.format(allDefs, setup, loop);\n  },\n\n  exportWorkspaceJavascript : function() {\n    return Blockly.JavaScript.workspaceToCode(this.get('workspace'));\n  },\n\n  importWorkspaceXml : function(xmlText) {\n    this.get('workspace').clear();\n    var xmlDom = Blockly.Xml.textToDom(xmlText);\n    Blockly.Xml.domToWorkspace(xmlDom, this.get('workspace'));\n  },\n\n  codeIsEmpty : function() {\n    var code = Blockly.JavaScript.workspaceToCode(this.get('workspace'));\n    return !code || !code.trim().length\n  },\n\n  clearWorkspace : function() {\n    this.get('workspace').clear();\n  }\n});\n\"use strict\";\n\nthis.app = app || {};\n\nthis.app.models = app.models || {};\n\nthis.app.models.FileSave = Backbone.Model.extend({\n  defaults: {\n    fileExtension : '',\n    defaultFileName : '',\n    extractCode : function() {}\n  },\n\n  initialize: function() {\n  },\n\n  downloadWithFileName : function(fileName) {\n    var text = this.get('extractCode')();\n    this.saveTextAsFile(text, this.formatFileName(fileName, this.get('fileExtension')));\n  },\n\n  saveTextAsFile : function(text, filename) {\n    /* Saves a text string as a blob file*/  \n    var ie = navigator.userAgent.match(/MSIE\\s([\\d.]+)/);\n    var ie11 = navigator.userAgent.match(/Trident\\/7.0/) && navigator.userAgent.match(/rv:11/);\n    var ieEDGE = navigator.userAgent.match(/Edge/g);\n    var ieVer=(ie ? ie[1] : (ie11 ? 11 : (ieEDGE ? 12 : -1)));\n\n    if (ie && ieVer < 10) {\n      console.log(\"No blobs on IE ver < 10.\");\n      return;\n    }\n\n    var textFileAsBlob = new Blob([text], {\n      type: 'text/plain'\n    });\n\n    if (ieVer > -1) {\n      window.navigator.msSaveBlob(textFileAsBlob, filename);\n    } else {\n      var downloadLink = document.createElement(\"a\");\n      downloadLink.download = filename;\n      downloadLink.href = window.URL.createObjectURL(textFileAsBlob);\n      downloadLink.onclick = function(e) { document.body.removeChild(e.target); };\n      downloadLink.style.display = \"none\";\n      document.body.appendChild(downloadLink);\n      downloadLink.click();\n    }\n  },\n\n  formatFileName : function(fileName, extension) {\n    fileName = fileName || this.get('defaultFileName') + extension;\n    if (fileName.length < 4 || fileName.substr(fileName.length - 4) != extension) {\n      fileName += extension;\n    }\n    return fileName;\n  }\n\n});\n\"use strict\";\n\nthis.app = app || {};\n\nthis.app.models = app.models || {};\n\nthis.app.models.Simulator = Backbone.Model.extend({\n  initialize : function() {\n    this.onWorkspaceChangeCallback = $.proxy(this.onWorkspaceChange, this);\n  },\n  enableSensorsHUD : function() {\n    me.game.HUD.enableHUD();\n  },\n\n  disableSensorsHUD : function() {\n    me.game.HUD.disableHUD();\n  },\n\n  onWorkspaceChange : function(event) {\n    if(event.type == Blockly.Events.CHANGE || \n      event.type == Blockly.Events.CREATE || \n      event.type == Blockly.Events.DELETE) {\n      /* If the code was modified, finish the execution */\n      me.execution.finish();\n      /* Remove the event listener */\n      app.blocklyModel.removeWorkspaceOnChangeListener(this.onWorkspaceChangeCallback);\n    }\n  },\n\n  pause : function(onPause) {\n    if(me.execution.isRunning()) {\n      onPause();\n      me.execution.pause();\n      /* While being paused, check if the code was modified */\n      app.blocklyModel.addWorkspaceOnChangeListener(this.onWorkspaceChangeCallback);\n    }\n  },\n\n  stop : function(onStop) {\n    if(!me.execution.hasFinished()) {\n      onStop();\n      me.execution.finish();\n      me.state.change(me.state.PLAY);\n    }\n  },\n\n  run : function(onRun, onCompleted) {\n    if(me.execution.hasFinished()) {\n      var code = app.blocklyModel.exportWorkspaceJavascript();\n      if(!code.length) {\n        module.notifyEmptyProgram();\n        return;\n      }\n      me.state.pause();\n      me.state.change(me.state.PLAY);\n      me.execution.onCompleted = onCompleted;\n      me.interpreter = this.get('interpreter').createInterpreter(code);\n      me.state.resume();\n    }\n    if(me.execution.isPaused()) {\n      /* Remove the event listener */\n      app.blocklyModel.removeWorkspaceOnChangeListener(this.onWorkspaceChangeCallback);\n    }\n    if(!me.execution.isRunning()) {\n      onRun();\n      me.execution.run();\n    }\n  },\n\n  changeMap : function(mapName) {\n    app.blocklyModel.clearWorkspace();\n    me.game.changeMap(mapName);\n  },\n\n  notifyEmptyProgram : _.throttle(function() {\n    toastr.info('No hay código para ejecutar.', 'Programa vacío', {timeOut: 2000});\n  }, 3000, {trailing: false}),\n\n  notifySaturationLeftWheel : _.throttle(function() {\n    this.notifySaturation('La potencia de la rueda izquierda está fuera del rango [-100, 100].');\n  }, 3000, {trailing: false}),\n\n  notifySaturationRightWheel : _.throttle(function() {\n    this.notifySaturation('La potencia de la rueda derecha está fuera del rango [-100, 100].');\n  }, 3000, {trailing: false}),\n\n  notifySaturation : function(mensaje) {\n    toastr.warning(mensaje, 'Potencia fuera de límite', {timeOut: 2000});\n  }\n});\n\"use strict\";\n\nthis.app = app || {};\n\nthis.app.models = app.models || {};\n\nthis.app.models.SimulatorInterpreter = Backbone.Model.extend({\n  initialize : function() {\n\n  },\n\n  createInterpreter : function(code) {\n    return new Interpreter(code, this.initApi);\n  },\n\n  initApi : function(interpreter, scope) {\n    interpreter.robotInstructions = new Array();\n\n    /* Add an API function for the motor function */\n    var motorWrapper = function(leftWheelValue, rightWheelValue, durationValue) {\n      if (leftWheelValue.data < -100 || leftWheelValue.data > 100) {\n        leftWheelValue.data = Math.max(-100, Math.min(100, leftWheelValue.data));\n        app.simulatorModel.notifySaturationLeftWheel();\n      }\n      if (rightWheelValue.data < -100 || rightWheelValue.data > 100) {\n        rightWheelValue.data = Math.max(-100, Math.min(100, rightWheelValue.data));\n        app.simulatorModel.notifySaturationRightWheel();\n      }\n      return interpreter.createPrimitive(\n        interpreter.robotInstructions.push(\n          {action : 'motor', \n          leftWheel : leftWheelValue.data,\n          rightWheel : rightWheelValue.data,\n          duration : durationValue.data\n          })\n      );\n    };\n\n    /* Add an API function for the sensor function */\n    var sensorWrapper = function(sensorName, callback) {\n      interpreter.robotInstructions.push({\n        action : 'sensor',\n        sensorName : sensorName,\n        sensorResultCallback : callback\n      });\n    };\n\n    /* Add an API function for the tracer enabler */\n    var tracerEnableWrapper = function(enabled) {\n      interpreter.robotInstructions.push(\n        {action : 'tracer_status', \n          enabled: enabled\n        });\n      return interpreter.createPrimitive(null);\n    };\n\n    /* Add an API function for the tracer colour */\n    var tracerColourWrapper = function(colour) {\n      interpreter.robotInstructions.push(\n        {action : 'tracer_colour', \n          colour: colour\n        })\n      return interpreter.createPrimitive(null);\n    };\n\n    var consoleLogWrapper = function(text) {\n      console.log(\"Console log: \");\n      console.log(text.data);\n      return interpreter.createPrimitive(null);\n    };\n\n    interpreter.setProperty(scope, 'sensor',\n        interpreter.createAsyncFunction(sensorWrapper));\n    interpreter.setProperty(scope, 'motor',\n        interpreter.createNativeFunction(motorWrapper));\n    interpreter.setProperty(scope, 'console_log',\n        interpreter.createNativeFunction(consoleLogWrapper));\n    interpreter.setProperty(scope, 'tracer_colour',\n        interpreter.createNativeFunction(tracerColourWrapper));\n    interpreter.setProperty(scope, 'tracer',\n        interpreter.createNativeFunction(tracerEnableWrapper));\n  }\n});\n\"use strict\";\n\nthis.app = app || {};\n\nthis.app.views = app.views || {};\n\napp.views.AppView = Backbone.View.extend({\n  initialize : function() {\n    $.material.init();\n    this.$homeNavbarCollapseElement = this.$el.find('#home-navbar-collapse');\n    this.$homeContentElement = this.$el.find(\"#home-content\");\n    this.$homeBlocklyWrapperElement = this.$el.find(\"#home-blockly-wrapper\");\n    this.$homeSimulatorWrapperElement = this.$el.find(\"#home-simulator-wrapper\");\n    this.$mapsModalElement = $(\"#maps-modal\");\n    this.$stateIndicatorElement = $(\"#state-indicator\");\n    \n    this.setInitialLayoutMode();\n\n    this.$homeNavbarCollapseElement.on('shown.bs.collapse hidden.bs.collapse', app.blocklyView.forceBlocklySvgResize);\n    this.$homeSimulatorWrapperElement.click($.proxy(this.toggleLayoutMode, this));\n  },\n  setInitialLayoutMode : function() {\n    if (_.contains([\"xs\", \"sm\"], this.getState())) {\n      this.setLayoutModeCollapsed();\n    } else { /* [\"md\", \"lg\"] */\n      this.setLayoutModeExpanded();\n    }\n  },\n\n  setLayoutModeCollapsed : function() {\n    this.$homeContentElement.removeClass('content-expanded');\n    this.$homeSimulatorWrapperElement.removeClass('simulator-expanded');\n    this.$homeBlocklyWrapperElement.removeClass('blockly-expanded');\n    this.$homeContentElement.addClass('content-collapsed');\n    this.$homeSimulatorWrapperElement.addClass('simulator-collapsed');\n    this.$homeBlocklyWrapperElement.addClass('blockly-collapsed');\n    app.simulatorView.enableSimulatorDragging();\n    app.simulatorView.onContainerResize();\n    app.blocklyView.onContainerResize();\n  },\n  \n  setLayoutModeExpanded : function() {\n    this.$homeContentElement.removeClass('content-collapsed');\n    this.$homeSimulatorWrapperElement.removeClass('simulator-collapsed');\n    this.$homeBlocklyWrapperElement.removeClass('blockly-collapsed');\n    this.$homeContentElement.addClass('content-expanded');\n    this.$homeSimulatorWrapperElement.addClass('simulator-expanded');\n    this.$homeBlocklyWrapperElement.addClass('blockly-expanded');\n    app.simulatorView.disableSimulatorDragging();\n    app.simulatorView.onContainerResize();\n    app.blocklyView.onContainerResize();\n  },\n  \n  toggleLayoutMode : function() {\n    if(this.$homeContentElement.hasClass('content-expanded')) {\n      this.setLayoutModeCollapsed();\n    } else {\n      this.setLayoutModeExpanded();\n    }\n  },\n\n  getState : function() {\n    var computedStyle = window.getComputedStyle(this.$stateIndicatorElement[0], ':before');\n    return computedStyle.getPropertyValue('content').replace(/\"/g,'') || 'unknown';\n  }\n\n});\n\"use strict\";\n\nthis.app = app || {};\n\nthis.app.views = app.views || {};\n\nthis.app.views.Blockly = Backbone.View.extend({\n\n  events: {\n    'change #hidden-file-input' : 'onHiddenFileInputChange',\n  },\n\n  render : function() {\n    var blocklyOptions = {\n      media: 'assets/blockly/',\n      sounds: true,\n      toolbox: document.getElementById('blockly-toolbox'),\n      rtl: false,\n      collapse: true,\n      comments: true,\n      css: true,\n      disable: true,\n      grid: false,\n      maxBlocks: Infinity,\n      zoom: {\n        controls: true,\n        wheel: false,\n        startScale: 0.8,\n        maxScale: 2,\n        minScale: 0.2,\n        scaleSpeed: 1.2\n      }\n    };\n    \n    this.workspace = Blockly.inject('blockly-div', blocklyOptions);\n    this.model.set('workspace', this.workspace);\n\n    // window.addEventListener('resize', this.onContainerResize, false);\n    this.onContainerResize();\n\n    Blockly.JavaScript.INFINITE_LOOP_TRAP = null;\n\n    /* Set math blocks color */\n    Blockly.Blocks.math.HUE = 35;\n\n  },\n\n  initialize : function() {\n    this.$hiddenFileInputElement = $('#hidden-file-input');\n    this.$blocklyDivElement = this.$el.find(\"#blockly-div\");\n    this.workspace = null; \n    this.$blocklyDivWrapperElement = this.$blocklyDivElement.parent();\n    $(window).on('resize.resizeview', this.onContainerResize.bind(this));\n    this.render();\n  },\n  \n  onContainerResize : function() {\n    var wrapperWidth = this.$blocklyDivWrapperElement.width();\n    var wrapperHeight = this.$blocklyDivWrapperElement.height();\n    this.$blocklyDivElement.width(wrapperWidth);\n    this.$blocklyDivElement.height(wrapperHeight);\n    this.forceBlocklySvgResize();\n  },\n\n  forceBlocklySvgResize : function() {\n    Blockly.svgResize(this.workspace);\n  },\n\n  /* Refactor this two functions */\n  loadProgram : function() {\n    this.$hiddenFileInputElement.click();\n  },\n\n  onTextLoad : function(event) {\n    this.model.importWorkspaceXml(event.target.result);\n  },\n\n  onHiddenFileInputChange : function(event) {\n    if (event.target.files.length > 0) {\n      var fileToLoad = event.target.files[0];\n      var reader = new FileReader();\n      reader.onload = $.proxy(this.onTextLoad, this);\n      reader.readAsText(fileToLoad);\n    }\n  },\n\n});\n  \"use strict\";\n\nthis.app = app || {};\n\nthis.app.views = app.views || {};\n\nthis.app.views.ConfigView = Backbone.View.extend({\n  initialize : function() {\n    this.$el.find(\"#sensor_hud_checkbox\").change(this.changeHUDCheckbox);\n    this.$modal = this.$el.find('.modal');\n  },\n\n  show : function() {\n  \tthis.$modal.modal('show');\n  },\n\n  hide : function() {\n    this.$modal.modal('hide');\n  },\n\n  changeHUDCheckbox : function() {\n    // Hide config modal.\n    app.configView.hide();\n    app.navBarView.toggleNavbar();\n    // Enable / disable HUD.\n    if($(this).is(':checked')) {\n      app.simulatorModel.enableSensorsHUD();\n    } else {\n      app.simulatorModel.disableSensorsHUD();\n    }\n  }\n});\n\"use strict\";\n\nthis.app = app || {};\n\nthis.app.views = app.views || {};\n\nthis.app.views.FileSave = Backbone.View.extend({\n  defaults: {},\n\n  events: {\n    'click .file-download-button' : 'onSaveButtonClick',\n    'click .file-cancel-button' : 'onCancelButtonClick',\n    'keypress .file-download-name-input': 'onInputKeyPress',\n  },\n\n  initialize : function() {\n    this.$fileNameInput = this.$el.find(\".file-download-name-input\");\n    this.$modal = this.$el.find(\".modal\");\n  },\n\n\trender : function() {\n    /* When showed, focus modal */\n    this.$modal.on('shown.bs.modal', function () {\n      this.$fileNameInput.focus();\n    });\n  },\n\n  onSaveButtonClick : function() {\n    // Modelo\n    this.model.downloadWithFileName(this.$fileNameInput.val());\n    this.hide();\n  },\n\n  onInputKeyPress : function (event) {\n    if (event.which == 13) {\n      event.preventDefault();\n      this.onSaveButtonClick();\n    }\n  },\n\n  onCancelButtonClick : function() {\n    this.hide();\n  },\n\n  show : function() {\n    this.$modal.modal('show');\n  },\n\n  hide : function() {\n    this.$modal.modal('hide');\n  },\n});\n\"use strict\";\n\nthis.app = app || {};\n\nthis.app.views = app.views || {};\n\nthis.app.views.MapsSelectorView = Backbone.View.extend({\n  initialize : function() {\n    this.$modal = this.$el.find('.modal');\n    this.$el.find('.media').click(this.onMapSelectionClick);\n  },\n  show : function() {\n    this.$modal.modal('show');\n  },\n  hide : function() {\n    this.$modal.modal('hide');\n  },\n  onMapSelectionClick : function () {\n    var selectedMap = $(this).attr(\"id\");\n    // Hide map selection modal.\n    app.mapsSelectorView.hide();\n    app.navBarView.toggleNavbar();\n    // If there is no code in workspace, change map. Otherwise, ask for confirmation first.\n    if(app.blocklyModel.codeIsEmpty()) {\n      app.simulatorModel.changeMap(selectedMap);\n    }\n    else {\n      bootbox.dialog({\n        message: \"Un cambio de mapa eliminará el código existente. Querés continuar?\",\n        title: \"Cambiar Mapa\",\n        buttons: {\n          default: {\n            label: \"Cancelar\",\n            className: \"btn-default\"\n          },\n          success: {\n            label: \"Cambiar mapa\",\n            className: \"btn-success\",\n            callback: function() {\n              app.simulatorModel.changeMap(selectedMap);\n            }\n          }\n        }\n      });\n    }\n  }\n  \n});\n\"use strict\";\n\nthis.app = app || {};\n\nthis.app.views = app.views || {};\n\nthis.app.views.NavBar = Backbone.View.extend({\n\n  events: {\n    'click .btn_run' : 'onClickRun',\n    'click .btn_pause' : 'onClickPause',\n    'click .btn_stop': 'onClickStop',\n    'click .btn_save' : 'onClickSave',\n    'click .btn_export' : 'onClickExport',\n    'click .btn_load' : 'onClickLoad',\n    'click .btn_maps': 'onClickMaps',\n    'click .btn_config' : 'onClickConfig'\n  },\n\n  initialize: function () {\n    this.$btn_run = this.$el.find('.btn_run');\n    this.$btn_pause = this.$el.find('.btn_pause');\n    this.$btn_stop = this.$el.find('.btn_stop');\n    this.$btn_save = this.$el.find('.btn_save');\n    this.$btn_export = this.$el.find('.btn_export');\n    this.$btn_load = this.$el.find('.btn_load');\n    this.$btn_maps = this.$el.find('.btn_maps');\n    this.$home_navbar_collapse = $('#home-navbar-collapse');\n    this.$home_navbar_collapse_button = $('#home-navbar-collapse-button');\n\n    key('ctrl+g, ⌘+g', keyHandler(this.onClickSave));\n    key('ctrl+a, ⌘+a', keyHandler(this.onClickLoad));\n    key('ctrl+e, ⌘+e', keyHandler(this.onClickRun));\n    key('ctrl+p, ⌘+p', keyHandler(this.onClickPause));\n    key('ctrl+d, ⌘+d', keyHandler(this.onClickStop));\n    key('ctrl+m, ⌘+m', keyHandler(this.onClickMaps));\n    \n    function keyHandler(handler) {\n      return function(event) {\n        handler(event);\n        event.preventDefault();\n        event.stopPropagation();\n      }\n    }\n  },\n\n  onClickConfig : function(event) {\n    app.configView.show();\n  },\n\n  onClickRun : function(event) {\n    var onCompleted = function() {\n      this.$btn_run.show();\n      this.$btn_pause.hide();\n      this.$btn_stop.addClass('disabled');\n    }\n    var onRun = function() {\n      this.$btn_pause.show();\n      this.$btn_stop.removeClass('disabled');\n      this.$btn_run.hide();\n    }\n    app.simulatorModel.run($.proxy(onRun, this), $.proxy(onCompleted, this));\n    event.stopPropagation();\n  },\n\n  onClickPause : function(event) {\n    var onPause = function() {\n      this.$btn_run.show();\n      this.$btn_pause.hide();\n    }\n    app.simulatorModel.pause($.proxy(onPause, this));\n  },\n\n  onClickStop : function(event) {\n    var onStop = function() {\n      this.$btn_run.show();\n      this.$btn_pause.hide();\n      this.$btn_stop.addClass('disabled');\n    }\n    app.simulatorModel.stop($.proxy(onStop, this));\n  },\n\n  onClickSave : function(event) {\n    app.downloadCodeView.show();\n  },\n\n  onClickExport : function(event) {\n    app.exportCodeView.show();\n  },\n\n  onClickLoad : function(event) {\n    app.blocklyView.loadProgram();\n  },\n\n  onClickMaps : function(event) {\n    app.mapsSelectorView.show();\n  },\n\n  toggleNavbar : function() {\n    if(this.$home_navbar_collapse.hasClass('in')) {\n      this.$home_navbar_collapse_button.click();\n    }\n  },\n\n  render: function () {\n  }\n\n});\n\"use strict\";\n\nthis.app = app || {};\n\nthis.app.views = app.views || {};\n\napp.views.Simulator = Backbone.View.extend({\n  initialize : function () {\n    /* Load melonjs game. */\n    me.interpreter = null;\n    game.onload(\"simulator-screen\");\n\n    // Mobile browser hacks\n    if (me.device.isMobile && !navigator.isCocoonJS) {\n        // Prevent the webview from moving on a swipe\n        window.document.addEventListener(\"touchmove\", function (e) {\n            e.preventDefault();\n            window.scroll(0, 0);\n            return false;\n        }, false);\n        // Scroll away mobile GUI\n        (function () {\n            window.scrollTo(0, 1);\n            me.video.onresize(null);\n        }).defer();\n        me.event.subscribe(me.event.WINDOW_ONRESIZE, function (e) {\n            window.scrollTo(0, 1);\n        });\n    }\n    $(window).on('resize.resizeview', this.render.bind(this));\n    $(window).on('orientationchange', this.render.bind(this));\n    this.$screenElement = this.$el.find(\"#simulator-screen\");\n    this.$canvasElement = this.$el.find(\"#simulator-screen > canvas\");\n    this.render();\n  },\n  /* Needs refactoring */\n  onContainerResize : function() {\n    var screenWrapperElement = this.$screenElement.parent();\n    var screenWrapperWidth = screenWrapperElement.width();\n    var screenWrapperHeight = screenWrapperElement.height();\n    var screenWidth = Math.min(screenWrapperWidth, screenWrapperHeight);\n    var screenHeight = screenWidth;\n    this.$screenElement.width(screenWidth);\n    this.$screenElement.height(screenHeight);\n    this.$canvasElement.width(screenWidth);\n    this.$canvasElement.height(screenHeight);\n  },\n\n  enableSimulatorDragging : function() {\n    this.$el.draggable({ containment: \"window\" });\n    this.$el.draggable('enable');\n  },\n  \n  disableSimulatorDragging : function() {\n    this.$el.draggable({ containment: \"window\" });\n    this.$el.draggable('disable');\n    this.$el.attr('style', '');\n  },\n\n  resetDraggablePosition : function() {\n    if (this.$el.hasClass('content-collapsed')) {\n      this.disableSimulatorDragging();\n      this.enableSimulatorDragging();\n    }\n  },\n\n  render : function() {\n    this.onContainerResize();\n    this.resetDraggablePosition();\n  }\n});\n\"use strict\";\n\nthis.app = app || {};\n\n$(document).ready(function() {\n  app.mapsSelectorView = new app.views.MapsSelectorView({el : '#maps-modal-wrapper'});\n\n  app.configView = new app.views.ConfigView({el : '#home-config-wrapper'});\n\n  app.navBarView = new app.views.NavBar({el: '#home-navbar-wrapper'});\n\n  app.blocklyModel = new app.models.Blockly();\n  app.blocklyView = new app.views.Blockly({el: '#home-blockly-wrapper', model: app.blocklyModel});\n\n  app.downloadCodeModel = new app.models.FileSave({\n    fileExtension : '.xml', \n    defaultFileName : 'xml-code',\n    extractCode : $.proxy(app.blocklyModel.exportWorkspaceXml, app.blocklyModel)\n  });\n  app.downloadCodeView = new app.views.FileSave({el: '#download-code-modal-wrapper', model : app.downloadCodeModel});\n\n  app.exportCodeModel = new app.models.FileSave({\n    fileExtension : '.ino', \n    defaultFileName : 'arduino-code',\n    extractCode : $.proxy(app.blocklyModel.exportWorkspaceArduino, app.blocklyModel)\n  });\n  app.exportCodeView = new app.views.FileSave({el: '#export-code-modal-wrapper', model : app.exportCodeModel});\n\n  app.simulatorInterpreterModel = new app.models.SimulatorInterpreter();\n  app.simulatorModel = new app.models.Simulator({interpreter : app.simulatorInterpreterModel});\n  app.simulatorView = new app.views.Simulator({el : '#home-simulator-wrapper', model : app.simulatorModel});\n\n  app.appView = new app.views.AppView({el : '#page-wrapper'});\n\n});"]}